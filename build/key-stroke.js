// Generated by CoffeeScript 1.8.0
(function() {
  var KeyKit, KeyStroke, _;

  _ = require('underscore-plus');

  KeyKit = require('./keykit');

  module.exports = KeyStroke = (function() {
    function KeyStroke(options) {
      var key, kit, _ref, _ref1, _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _ref8;
      if (options == null) {
        options = {};
      }
      this.ctrl = (_ref = options.ctrl) != null ? _ref : false;
      this.alt = (_ref1 = options.alt) != null ? _ref1 : false;
      this.shift = (_ref2 = options.shift) != null ? _ref2 : false;
      this.meta = (_ref3 = options.meta) != null ? _ref3 : false;
      this.name = (_ref4 = options.name) != null ? _ref4 : null;
      this.identifier = (_ref5 = options.identifier) != null ? _ref5 : null;
      this.code = (_ref6 = (_ref7 = (_ref8 = options.code) != null ? _ref8 : options.keyCode) != null ? _ref7 : options.keycode) != null ? _ref6 : null;
      kit = require('./keykit');
      if (this.code != null) {
        key = kit.findByCode(this.code);
        this.name = key.name;
        if (_.isArray(key.char)) {
          if (!this.shift) {
            this.char = key.char[0];
          }
          if (this.shift) {
            this.char = key.char[1];
          }
        } else {
          this.char = key.char;
        }
      } else if (this.name != null) {
        this.code = kit.findByName(this.name).code;
      } else {
        throw new Error("Keycode or name needed");
      }
    }

    KeyStroke.prototype.toString = function() {
      var kit, s, visible;
      kit = require('./keykit');
      visible = kit.keysByCode[this.code].visible;
      if (kit.isModifier(this.code)) {
        return this.name;
      } else if (!(this.ctrl || this.alt) && visible) {
        return this.char;
      } else {
        s = "";
        s += (this.ctrl ? "ctrl-" : "");
        s += (this.alt ? "alt-" : "");
        s += (this.shift ? "shift-" : "");
        s += this.name.toLowerCase();
        return s;
      }
    };

    KeyStroke.prototype.vimEscaped = function() {
      var kc, kit, name, s, visible;
      kit = require('./keykit');
      kc = kit.keysByCode[this.code];
      visible = kc.visible;
      if (_.contains([16, 17, 18], this.code)) {
        return '';
      } else if (!(this.ctrl || this.alt) && visible) {
        if (typeof kc.char !== 'string') {
          if (this.char === '<') {
            return '<LT>';
          }
          if (!this.shift) {
            return kc.char[0];
          }
          if (this.shift) {
            return kc.char[1];
          }
        } else {
          return kc.char;
        }
      } else {
        s = "";
        s += (this.ctrl ? "C-" : "");
        s += (this.alt ? "A-" : "");
        s += (this.shift ? "S-" : "");
        name = kit.vimCodeByKeyname[this.name] || this.name.toLowerCase();
        if (name === 'LT') {
          name = '<LT>';
        }
        s += name;
        return "<" + s + ">";
      }
    };

    return KeyStroke;

  })();

}).call(this);
